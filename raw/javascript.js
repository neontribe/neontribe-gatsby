const colours = ['#54FCFD', '#9013FE', '#48E6B6', '#FB37F1', '#FDF958']

window.entries = []

window.entries.push({
  title: 'Mind of my Own',
  bannerimage: 'ourwork-momobanner.jpg',
  image: 'ourwork-momo.jpg',
  description: `We work with Mind of My Own to help young people participate fully in their care and make it easier to speak up anytime they want. We’ve built apps that make this happen, 
    leading on many aspects of the process.`,
  problem: `Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.`,
  solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
  destination: 'https://www.mindofmyown.org.uk',
})

window.entries.push({
  title: 'Alexander Rose',
  bannerimage: 'ourwork-arcbanner.jpg',
  image: 'ourwork-arc.jpg',
  description: `Neontribe are helping Alexandra Rose Charity develop a series of digital tools so that they can scale up the number of areas, markets and families included in their award winning 
    fruit and veg project for families in or at risk of food poverty.`,
  problem: `dolore magna aliquyam erat, sed diam voluptua.`,
  solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
  destination: 'https://www.alexandrarose.org.uk',
})

window.entries.push({
  title: 'seAp',
  bannerimage: 'ourwork-seapbanner.jpg',
  image: 'ourwork-.jpg',
  description: `A national advocacy charity, seAp, approached us in 2014 to create a virtual advocate tool that would help people through the confusing and intimidating process 
    of applying for benefits. `,
  problem: `dolore magna aliquyam erat, sed diam voluptua.`,
  solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
  destination: 'www.c-app.org.uk',
})

window.entries.push({
  title: 'The Haven',
  bannerimage: 'ourwork-havenbanner.jpg',
  image: 'ourwork-haven.jpg',
  description: `As part of the Comic Relief’s tech vs abuse initiative Neontribe and The Haven (Wolverhampton) worked with survivors to create a digital 
    tool which helps women realise they are in an abusive relationship and dispel their fears about taking action. `,
  problem: `dolore magna aliquyam erat, sed diam voluptua.`,
  solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
  destination: 'www.youmatterhaven.org.uk',
})

window.entries.push({
  title: 'Allegiant Air',
  bannerimage: 'ourwork-allegiantbanner.jpg',
  image: 'ourwork-allegiant.jpg',
  description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
    Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
  problem: `dolore magna aliquyam erat, sed diam voluptua.`,
  solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
  destination: 'https://www.allegiantair.com',
})

window.entries.push({
    title: 'NCVO',
    bannerimage: 'ourwork-ncvobanner.jpg',
    image: 'ourwork-ncvo.jpg',
    description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
      Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
    problem: `dolore magna aliquyam erat, sed diam voluptua.`,
    solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
    destination: 'https://www.allegiantair.com',
})

window.entries.push({
    title: 'Open Data Studios',
    bannerimage: 'banner-pink.jpg',
    image: 'ourwork-opendata.jpg',
    description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
      Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
    problem: `dolore magna aliquyam erat, sed diam voluptua.`,
    solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
    destination: 'https://www.allegiantair.com',
})

window.entries.push({
    title: 'UKCF',
    bannerimage: 'banner-blue.jpg',
    image: 'ourwork-ukcf.jpg',
    description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
      Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
    problem: `dolore magna aliquyam erat, sed diam voluptua.`,
    solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
    destination: 'https://www.allegiantair.com',
})

window.entries.push({
    title: 'Addaction',
    bannerimage: 'banner-yellow.jpg',
    image: 'ourwork-addaction.jpg',
    description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
      Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
    problem: `dolore magna aliquyam erat, sed diam voluptua.`,
    solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
    destination: 'https://www.allegiantair.com',
})

window.entries.push({
    title: 'Docready',
    bannerimage: 'banner-green.jpg',
    image: 'ourwork-docready.jpg',
    description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
      Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
    problem: `dolore magna aliquyam erat, sed diam voluptua.`,
    solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
    destination: 'https://www.allegiantair.com',
})

window.entries.push({
    title: 'A Day In The Life',
    bannerimage: 'banner-pink.jpg',
    image: 'ourwork-day.jpg',
    description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
      Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
    problem: `dolore magna aliquyam erat, sed diam voluptua.`,
    solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
    destination: 'https://www.allegiantair.com',
})

window.entries.push({
    title: 'Innovation Labs',
    bannerimage: 'banner-purple.jpg',
    image: 'ourwork-innovation.jpg',
    description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
      Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
    problem: `dolore magna aliquyam erat, sed diam voluptua.`,
    solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
    destination: 'https://www.allegiantair.com',
})

window.entries.push({
    type: 'talk',
    title: 'Harry and Rupert',
    bannerimage: 'ourwork-innovationbanner.jpg',
    image: 'ourwork-innovation.jpg',
    description: `We work with our colleagues at Lola Tech to build, maintain and update a responsive and reliable website for a major American airline, Allegiant Air. Currently, 
      Lola Tech and Neontribe are developing Allegiant's all-new stack that will replace the last version we built, which is now 7 years old. `,
    problem: `dolore magna aliquyam erat, sed diam voluptua.`,
    solution: `Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat`,
    destination: 'https://www.allegiantair.com',
})


const entriesEl = document.getElementById('entries')
if (entriesEl) {
  document.getElementById('entries').innerHTML = window.entries
    .map(
      (entry, index) => `
    <div class="w-100">
    <img class="fl mr3 mb2" src="./${
      entry.image
    }" alt="screenshot of mind of our own app" /> 
    <h3 class="text">${entry.title}</h3>
    <p class="fw7">${entry.quote}</p>
    <p>
        ${entry.description}
        <a
        href="${entry.destination}"
        class="nowrap link"
        onmouseover="this.firstElementChild.style.borderBottomColor = '${
          colours[index % colours.length]
        }'"
        onmouseout="this.firstElementChild.style.borderBottomColor = null"
        onfocus="this.firstElementChild.style.borderBottomColor = '${
          colours[index % colours.length]
        }'"
        onblur="this.firstElementChild.style.borderBottomColor = null"
        >
        <span class="our-work-entry-link" data-color="${
          colours[index % colours.length]
        }">
            ${
              entry.destination.indexOf('://') !== -1
                ? entry.destination.split('://')[1]
                : entry.destination
            }
        </span>
        <span style="color: ${colours[index % colours.length]};">&rarr;</span>
        </a>
    </p>
    <div class="cb">
        <div>
        <h4 class="our-work-entry-problem text fl ma0">Problem:</h3>
        <p>${entry.problem}</p>
        </div>
        <div>
        <h4 class="our-work-entry-solution text fl ma0">Solution:</h3>
        <p>${entry.solution}</p>
        </div>
    </div>
    </div>

`
    )
    .join('')
}
const focusable = document.querySelectorAll(
  'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
)

focusable.forEach((element, index) => {
  element.addEventListener('focus', event => {
    const color = colours[index % colours.length]
    event.target.style.borderColor = color
    event.target.style.boxShadow = `0 0 8px ${color}`
  })

  element.addEventListener('blur', event => {
    event.target.style.borderColor = null
    event.target.style.boxShadow = null
  })
})

const profiles = [
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['CSS', 'Javascript', 'Python'],
  },
  {
    name: 'Bruce Wayne',
    image: './thetribe1.png',
    title: 'Back-end Developer',
    description:
      'At vero eos et accusam et justo duo dolores et ea rebumumy sed tempor et et invidunt justo labore Stet clita ea et gubergren. Rebumumy sed tempor. At vero eos et accusam et',
    skills: ['Design', 'Typography', 'Layout'],
  },
]

//  Todo: add arrow color and border color on focus/hover
const profilesEl = document.getElementById('profiles')
if (profilesEl) {
  profilesEl.innerHTML = profiles
    .map(
      (profile, index) => `

    <div class="fl pa2">
        <button type="button" class="flip-button" onclick="flip(this)">
            <span class="flip-container">
                <span class="flipper">
                    <span class="front relative flex flex-column items-center">
                        <img class="tribe-image" src="${
                          profile.image
                        }" alt="" />
                        <span class="absolute bottom-1 flex justify-center right-0 top-0 w-100">
                            <span class="text-name absolute bottom--1 right-0 fw7">
                            ${profile.name}
                            <span class="arrowpink">&rarr;</span>
                        </span>
                        <span class="absolute left-0 top-1 tl">
                            ${profile.skills
                              .map(
                                skill => `
                                <div>
                                    <span class="text-name fw4 f6 mb2 tl">
                                        ${skill} 
                                    </span>
                                </div>
                            `
                              )
                              .join('')}
                        </span>
                    </span>
                </span>
                <span class="back">
                    <h4>${profile.name}</h4>
                    <div class="i f6 mb2">${profile.skills}</div>
                    <div class="smallparagraph">${profile.description}</div>
                </span>
            </span>
        </button>
    </div>
`
    )
    .join('')
}

window.flip = el => {
  Array.from(document.getElementsByClassName('flip-button'))
    .filter(item => {
      return item !== el
    })
    .forEach(item => {
      item.classList.remove('active')
    })
  el.classList.toggle('active')
}

Array.from(document.getElementsByClassName('slides')).forEach(el => {
  el.style.width = `calc(100% * ${el.childElementCount})`
})

window.goTo = (carouselEl, index) => {
  const slidesEl = carouselEl.querySelector('.slides')
  const slideCount = slidesEl.childElementCount
  slidesEl.setAttribute('data-active-index', index)
  slidesEl.style.transform = `translateX(calc((100% / -${slideCount}) * ${index}))`
}

window.prev = carouselEl => {
  const slidesEl = carouselEl.querySelector('.slides')
  const slideCount = slidesEl.childElementCount
  const slideIndex = parseInt(slidesEl.getAttribute('data-active-index'), 10)
  var nextSlideIndex = slideIndex - 1
  if (nextSlideIndex < 0) {
    nextSlideIndex = slideCount - 1
  }

  window.goTo(carouselEl, nextSlideIndex)
}

window.next = carouselEl => {
  const slidesEl = carouselEl.querySelector('.slides')
  const slideCount = slidesEl.childElementCount
  const slideIndex = parseInt(slidesEl.getAttribute('data-active-index'), 10)
  var nextSlideIndex = slideIndex + 1
  if (nextSlideIndex >= slideCount) {
    nextSlideIndex = 0
  }

  window.goTo(carouselEl, nextSlideIndex)
}

var acc = document.getElementsByClassName("accordion");

for (var i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    /* Toggle between adding and removing the "active" class,
    to highlight the button that controls the panel */
    this.classList.toggle("active");

    /* Toggle between hiding and showing the active panel */
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}

// howwework -------------------------------------------------------------------------------------------------------------------

window.toggleWorkEntry = function(el) {
    const entryEl = el.closest('.work-entry');
    const article = entryEl.querySelector('article');

    document.querySelectorAll('.work-entry').forEach(entry => {
        if (entryEl !== entry) {
            entry.querySelector('article').setAttribute('aria-hidden', 'true');
        } else {
            entry.querySelector('article').toggleAttribute('aria-hidden');
        }
    });
};

function getEntryTemplate(entry) {
    return `
        <div class="work-entry mb3">
            <div class="work-entry-${entry.title.split(' ').join('-').toLowerCase()} work-entry-bg-image pa3" onclick="toggleWorkEntry(this)" style="background-image: url('${entry.bannerimage}')">
                <h3 class="text mb2">${entry.title}</h3>
                <p class="text">${entry.description}</p>
                <button type="button" class="visually-hidden" onclick="toggleWorkEntry(this)">View problem and solution for ${entry.title}</button>
            </div>
            <article class="pa3" aria-hidden>
                <div class="mb2 text">
                <img src="${entry.image}" class="fl mr3 mb2" alt="${entry.imagedescription}" />
                <h3 class="mb1">${entry.title}</h3>
                <a href="${entry.destination}" class="pl3 pr3 text link-small">${entry.destination.split('://')[1]} <span class="arrowpink">&rarr;</span></a>
                    <p>Problem: ${entry.problem} </p>
                    <p>Solution: ${entry.solution}</p>
                </div>
            </article>
        </div>
    `;
}

document.getElementById('our-work').innerHTML = window.entries.filter(entry => entry.type !== 'talk').map(entry => getEntryTemplate(entry)).join('');

document.getElementById('our-talks').innerHTML = window.entries.filter(entry => entry.type === 'talk').map(entry => getEntryTemplate(entry)).join('');